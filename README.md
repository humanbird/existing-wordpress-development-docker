# Existing WordPress site development - Docker

## Notice

**Unfortunately, I no longer have time to manage this project so it has been publicly archived.**

-----------

Quickly creates a local development environment for an *existing* WordPress site.

This application requires Docker to be up and running and for Docker Compose to also be installed.

The `docker-compose.yml` file defines 2 containers:

- `wordpress` - for the website files.
- `db` - for the associated MariaDB database.

The `wordpress` container has 2 volumes:

1. The `site/wp-content` folder - Copy the `wp-content` folder from the production site. It's used for all customizations outside of the core WordPress code. This includes the themes, plugins, uploads, etc.
2. `init/prep.sh` - Disables plugins as defined in the `.env` file. It also makes the `wp-content` folder the same owner/group as the rest of the site.

**Note:** The `wp-config.php` file gets auto-generated for this local WordPress instance.

The `db` container has 3 volumes:

1. `database` - A folder for all of the MariaDB files, this gets automatically generated by Docker and can remain untouched for average usage.
2. `mysqldumps/backup.sql.gz` - This is a snapshot taken from the production instance via `mysqldump`, place the file in this location and it will get imported on the first run of the container automatically.
3. `init/migrate.sh` - A URL migration script, this updates the URL stored in the database, this also gets run automatically when the containers are spun up for the first time.

## Usage

1. Clone or download this project.

2. Create a `mysqldump` from your pre-existing site and place it in the location: `mysqldumps/backup.sql.gz` (ensure the file is named `backup.sql.gz`).

3. Obtain a copy of the `wp-content` folder from the pre-existing site and place it in the location: `site/wp-content`.

4. Enter your configuration variables into `.env`.

5. Navigate to the root of this project locally and run:

    ```sh
    docker-compose up -d && docker-compose exec wordpress prep.sh
    ```

The website will then be available at `http://localhost` and the WordPress dashboard at `http://localhost/wp-admin`.

## Creating a Docker Image

To create a Docker image for sharing or deployment:

1. Ensure you have Docker installed and running on your machine.
2. Navigate to the root directory of your project.
3. Build the Docker image using the following command:

    ```sh
    docker build -t your_dockerhub_username/wordpress-dev:latest .
    ```

4. Push the Docker image to Docker Hub (or your preferred Docker registry):

    ```sh
    docker push your_dockerhub_username/wordpress-dev:latest
    ```

Replace `your_dockerhub_username` with your actual Docker Hub username.

## .gitignore

Make sure your `.gitignore` file is set up to exclude unnecessary and sensitive files:

```plaintext
# WordPress core
wp-admin/
wp-includes/

# WordPress content
site/wp-content/uploads/
site/wp-content/upgrade/
site/wp-content/cache/
site/wp-content/backup-db/
site/wp-content/blogs.dir/
site/wp-content/advanced-cache.php
site/wp-content/wp-cache-config.php
site/wp-content/cache-config.php
site/wp-content/mu-plugins/

# WordPress configuration files
wp-config.php

# Logs and databases
*.log
*.sql
*.sqlite
*.sql.gz

# System files
.DS_Store
Thumbs.db
ehthumbs.db
Desktop.ini
$RECYCLE.BIN/
*.bak
*.swp

# IDE files
.vscode/
.idea/
*.sublime-workspace
*.sublime-project

# Docker
database/
mysqldumps/backup.sql.gz

# Node.js dependencies
node_modules/
npm-debug.log

# Composer dependencies
vendor/
composer.lock

# Misc
.env
